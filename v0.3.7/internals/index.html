<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · TransformVariables.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>TransformVariables.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li class="current"><a class="toctext" href>Internals</a><ul class="internal"><li><a class="toctext" href="#Types-for-various-transformations-1">Types for various transformations</a></li><li><a class="toctext" href="#Types-and-type-aliases-1">Types and type aliases</a></li><li><a class="toctext" href="#Conditional-calculation-of-log-Jacobian-determinant-1">Conditional calculation of log Jacobian determinant</a></li><li><a class="toctext" href="#Macros-1">Macros</a></li><li><a class="toctext" href="#Helper-functions-1">Helper functions</a></li><li><a class="toctext" href="#Building-blocks-for-transformations-1">Building blocks for transformations</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Internals</a></li></ul><a class="edit-page" href="https://github.com/tpapp/TransformVariables.jl/blob/master/docs/src/internals.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Internals</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Internals-1" href="#Internals-1">Internals</a></h1><h2><a class="nav-anchor" id="Types-for-various-transformations-1" href="#Types-for-various-transformations-1">Types for various transformations</a></h2><p>These are not part of the API, use the <code>as</code> constructor or one of the predefined constants.</p><h3><a class="nav-anchor" id="Scalar-transformations-1" href="#Scalar-transformations-1">Scalar transformations</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.Identity" href="#TransformVariables.Identity"><code>TransformVariables.Identity</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct Identity &lt;: TransformVariables.ScalarTransform</code></pre><p>Identity <span>$x ↦ x$</span>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.ScaledShiftedLogistic" href="#TransformVariables.ScaledShiftedLogistic"><code>TransformVariables.ScaledShiftedLogistic</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct ScaledShiftedLogistic{T&lt;:Real} &lt;: TransformVariables.ScalarTransform</code></pre><p>Maps to <code>(scale, shift + scale)</code> using <code>x ↦ logistic(x)*scale + shift</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.ShiftedExp" href="#TransformVariables.ShiftedExp"><code>TransformVariables.ShiftedExp</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct ShiftedExp{D, T&lt;:Real} &lt;: TransformVariables.ScalarTransform</code></pre><p>Shifted exponential. When <code>D::Bool == true</code>, maps to <code>(shift, ∞)</code> using <code>x ↦ shift + eˣ</code>, otherwise to <code>(-∞, shift)</code> using <code>x ↦ shift - eˣ</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section><h3><a class="nav-anchor" id="Aggregating-transformations-1" href="#Aggregating-transformations-1">Aggregating transformations</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.ArrayTransform" href="#TransformVariables.ArrayTransform"><code>TransformVariables.ArrayTransform</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct ArrayTransform{T&lt;:TransformVariables.AbstractTransform, M} &lt;: TransformVariables.VectorTransform</code></pre><p>Apply <code>transformation</code> repeatedly to create an array with given <code>dims</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.TransformTuple" href="#TransformVariables.TransformTuple"><code>TransformVariables.TransformTuple</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct TransformTuple{T} &lt;: TransformVariables.VectorTransform</code></pre><p>Transform consecutive groups of real numbers to a tuple, using the given transformations.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaLang/julia/blob/3af96bcefcb0aec559d4652fd75e1bc3fcfe99da/base/#L0">source</a></section><h3><a class="nav-anchor" id="Wrapper-for-inverse-1" href="#Wrapper-for-inverse-1">Wrapper for inverse</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.InverseTransform" href="#TransformVariables.InverseTransform"><code>TransformVariables.InverseTransform</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct InverseTransform{T}</code></pre><p>Inverse of the wrapped transform. Use the 1-argument version of <a href="../#TransformVariables.inverse"><code>inverse</code></a> to construct.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L113">source</a></section><h2><a class="nav-anchor" id="Types-and-type-aliases-1" href="#Types-and-type-aliases-1">Types and type aliases</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.AbstractTransform" href="#TransformVariables.AbstractTransform"><code>TransformVariables.AbstractTransform</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">abstract type AbstractTransform</code></pre><p>Supertype for all transformations in this package.</p><p><strong>Interface</strong></p><p>The user interface consists of</p><ul><li><a href="../#TransformVariables.dimension"><code>dimension</code></a></li><li><a href="../#TransformVariables.transform"><code>transform</code></a></li><li><a href="../#TransformVariables.transform_and_logjac"><code>transform_and_logjac</code></a></li><li>[<code>inverse</code>]@(ref), <a href="../#TransformVariables.inverse!"><code>inverse!</code></a></li><li><a href="../#TransformVariables.inverse_eltype"><code>inverse_eltype</code></a>.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L94">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.ScalarTransform" href="#TransformVariables.ScalarTransform"><code>TransformVariables.ScalarTransform</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">abstract type ScalarTransform &lt;: TransformVariables.AbstractTransform</code></pre><p>Transform a scalar (real number) to another scalar.</p><p>Subtypes mustdefine <code>transform</code>, <code>transform_and_logjac</code>, and <code>inverse</code>; other methods of of the interface should have the right defaults.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/scalar.jl#L4">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.VectorTransform" href="#TransformVariables.VectorTransform"><code>TransformVariables.VectorTransform</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">abstract type VectorTransform &lt;: TransformVariables.AbstractTransform</code></pre><p>Transformation that transforms <code>&lt;: AbstractVector</code>s to other values.</p><p><strong>Implementation</strong></p><p>Implements <a href="../#TransformVariables.transform"><code>transform</code></a> and <a href="../#TransformVariables.transform_and_logjac"><code>transform_and_logjac</code></a> via <a href="#TransformVariables.transform_with"><code>transform_with</code></a>, and <a href="../#TransformVariables.inverse"><code>inverse</code></a> via <a href="../#TransformVariables.inverse!"><code>inverse!</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L201">source</a></section><h2><a class="nav-anchor" id="Conditional-calculation-of-log-Jacobian-determinant-1" href="#Conditional-calculation-of-log-Jacobian-determinant-1">Conditional calculation of log Jacobian determinant</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.LogJacFlag" href="#TransformVariables.LogJacFlag"><code>TransformVariables.LogJacFlag</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">abstract type LogJacFlag</code></pre><p>Flag used internally by the implementation of transformations, as explained below.</p><p>When calculating the log jacobian determinant for a matrix, initialize with</p><pre><code class="language-julia">logjac_zero(flag, x)</code></pre><p>and then accumulate with log jacobians as needed with <code>+</code>.</p><p>When <code>flag</code> is <code>LogJac</code>, methods should return the log Jacobian as the second argument, otherwise <code>NoLogJac</code>, which simply combines to itself with <code>+</code>, serving as an empty placeholder. This allows methods to share code of the two implementations.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L8">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.LogJac" href="#TransformVariables.LogJac"><code>TransformVariables.LogJac</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Calculate log Jacobian as the second value.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L26-L28">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.NoLogJac" href="#TransformVariables.NoLogJac"><code>TransformVariables.NoLogJac</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Don&#39;t calculate log Jacobian, return <code>NOLOGJAC</code> as the second value.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L33-L35">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.logjac_zero" href="#TransformVariables.logjac_zero"><code>TransformVariables.logjac_zero</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">logjac_zero(?, T)
</code></pre><p>Initial value for log Jacobian calculations.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L42">source</a></section><h2><a class="nav-anchor" id="Macros-1" href="#Macros-1">Macros</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.@calltrans" href="#TransformVariables.@calltrans"><code>TransformVariables.@calltrans</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><p>Workaround for https://github.com/JuliaLang/julia/issues/14919 to make transformation types callable.</p><p>TODO: remove when this issue is closed, also possibly remove MacroTools as a dependency if not used elsewhere.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/utilities.jl#L49">source</a></section><h2><a class="nav-anchor" id="Helper-functions-1" href="#Helper-functions-1">Helper functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.transform_with" href="#TransformVariables.transform_with"><code>TransformVariables.transform_with</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">transform_with(flag::LogJacFlag, transformation, x::AbstractVector, index)</code></pre><p>Transform elements of <code>x</code> from <code>index</code>, using <code>transformation</code>.</p><p>Return <code>(y, logjac), index′</code>, where</p><ul><li><p><code>y</code> is the result of the transformation,</p></li><li><p><code>logjac</code> is the the log Jacobian determinant or a placeholder, depending on <code>flag</code>,</p></li><li><p><code>index′</code> is the next index in <code>x</code> after the elements used for the transformation</p></li></ul><p><strong>Internal function</strong>. Implementations</p><ol><li>can assume that <code>x</code> has enough elements for <code>transformation</code> (ie <code>@inbounds</code> can be</li></ol><p>used),</p><ol><li>should work with generalized indexing on <code>x</code>.</li></ol></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/generic.jl#L55-L74">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables._transform_tuple" href="#TransformVariables._transform_tuple"><code>TransformVariables._transform_tuple</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">_transform_tuple(flag, x, index, ?)
</code></pre><p>Helper function for transforming tuples. Used internally, to help type inference. Use via <code>transfom_tuple</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/aggregation.jl#L150">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables._inverse!_tuple" href="#TransformVariables._inverse!_tuple"><code>TransformVariables._inverse!_tuple</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">_inverse!_tuple(x, index, ts, ys)
</code></pre><p>Helper function for inverting tuples of transformations. Used internally.</p><p><em>Performs no argument validation, caller should do this.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/aggregation.jl#L186">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables._inverse_eltype_tuple" href="#TransformVariables._inverse_eltype_tuple"><code>TransformVariables._inverse_eltype_tuple</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">_inverse_eltype_tuple(ts, ys)
</code></pre><p>Helper function determining element type of inverses from tuples. Used internally.</p><p><em>Performs no argument validation, caller should do this.</em></p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/aggregation.jl#L175">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.unit_triangular_dimension" href="#TransformVariables.unit_triangular_dimension"><code>TransformVariables.unit_triangular_dimension</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">unit_triangular_dimension(n)
</code></pre><p>Number of elements (strictly) above the diagonal in an <span>$n×n$</span> matrix.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/utilities.jl#L20-L24">source</a></section><h2><a class="nav-anchor" id="Building-blocks-for-transformations-1" href="#Building-blocks-for-transformations-1">Building blocks for transformations</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.l2_remainder_transform" href="#TransformVariables.l2_remainder_transform"><code>TransformVariables.l2_remainder_transform</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">(y, r, ℓ) =</code></pre><pre><code class="language-julia">l2_remainder_transform(flag, x, r)
</code></pre><p>Given <span>$x ∈ ℝ$</span> and <span>$0 ≤ r ≤ 1$</span>, return <code>(y, r′)</code> such that</p><ol><li><p><span>$y² + r′² = r²$</span>,</p></li><li><p><span>$y: |y| ≤ r$</span> is mapped with a bijection from <code>x</code>.</p></li></ol><p><code>ℓ</code> is the log Jacobian (whether it is evaluated depends on <code>flag</code>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/special_arrays.jl#L7-L17">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="TransformVariables.l2_remainder_inverse" href="#TransformVariables.l2_remainder_inverse"><code>TransformVariables.l2_remainder_inverse</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">(x, r′) =</code></pre><pre><code class="language-julia">l2_remainder_inverse(y, r)
</code></pre><p>Inverse of <a href="#TransformVariables.l2_remainder_transform"><code>l2_remainder_transform</code></a> in <code>x</code> and <code>y</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tpapp/TransformVariables.jl/blob/12792da24edf211565a1f36b04a02cb393fd9c04/src/special_arrays.jl#L24-L28">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Introduction</span></a></footer></article></body></html>
